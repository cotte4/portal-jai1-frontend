<div class="reset-container">
  <!-- Left side - Branding -->
  <div class="branding-section">
    <div class="branding-content">
      <div class="logo">JAI1</div>
      <h1>Nueva contrasena</h1>
      <p>Crea una contrasena segura para proteger tu cuenta y continuar usando nuestros servicios.</p>
    </div>
  </div>

  <!-- Right side - Form -->
  <div class="form-section">
    <div class="form-container">

      <!-- Invalid Token State -->
      <div class="error-content" *ngIf="!isTokenValid && !isSubmitted">
        <!-- Back Link -->
        <a class="back-link" (click)="goToLogin()">
          <span class="back-icon">â†</span>
          Volver al inicio de sesion
        </a>

        <!-- Error Icon -->
        <div class="error-icon-wrapper">
          <div class="error-icon">âš ï¸</div>
        </div>

        <!-- Error Message -->
        <div class="error-message-block">
          <h2>Enlace invalido</h2>
          <p>Este enlace de recuperacion no es valido o ha expirado. Por favor solicita uno nuevo.</p>
        </div>

        <!-- Actions -->
        <div class="error-actions">
          <button class="btn-primary" (click)="goToForgotPassword()">
            Solicitar nuevo enlace
          </button>
        </div>
      </div>

      <!-- Reset Form (Initial State) -->
      <div class="form-content" *ngIf="isTokenValid && !isSubmitted">
        <!-- Back Link -->
        <a class="back-link" (click)="goToLogin()">
          <span class="back-icon">â†</span>
          Volver al inicio de sesion
        </a>

        <!-- Header -->
        <div class="form-header">
          <div class="header-icon">ğŸ”‘</div>
          <h2>Crea tu nueva contrasena</h2>
          <p>Tu nueva contrasena debe tener al menos 8 caracteres.</p>
        </div>

        <!-- Error Message -->
        <div class="error-message" *ngIf="errorMessage">
          {{ errorMessage }}
        </div>

        <!-- Form -->
        <form class="reset-form" (ngSubmit)="onSubmit()">
          <div class="form-group">
            <label for="newPassword">Nueva contrasena</label>
            <div class="password-input-wrapper">
              <input
                [type]="showPassword ? 'text' : 'password'"
                id="newPassword"
                [(ngModel)]="newPassword"
                name="newPassword"
                placeholder="Minimo 8 caracteres"
                [disabled]="isLoading"
                required
              >
              <button type="button" class="toggle-password" (click)="togglePassword()">
                {{ showPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
              </button>
            </div>
          </div>

          <div class="form-group">
            <label for="confirmPassword">Confirmar contrasena</label>
            <div class="password-input-wrapper">
              <input
                [type]="showConfirmPassword ? 'text' : 'password'"
                id="confirmPassword"
                [(ngModel)]="confirmPassword"
                name="confirmPassword"
                placeholder="Repite tu contrasena"
                [disabled]="isLoading"
                required
              >
              <button type="button" class="toggle-password" (click)="toggleConfirmPassword()">
                {{ showConfirmPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
              </button>
            </div>
          </div>

          <!-- Password Requirements -->
          <div class="password-requirements">
            <div class="requirement" [class.met]="newPassword.length >= 8">
              <span class="check">{{ newPassword.length >= 8 ? 'âœ“' : 'â—‹' }}</span>
              Minimo 8 caracteres
            </div>
            <div class="requirement" [class.met]="newPassword && newPassword === confirmPassword">
              <span class="check">{{ newPassword && newPassword === confirmPassword ? 'âœ“' : 'â—‹' }}</span>
              Las contrasenas coinciden
            </div>
          </div>

          <button type="submit" class="btn-primary" [disabled]="isLoading">
            <span *ngIf="!isLoading">Cambiar contrasena</span>
            <span *ngIf="isLoading" class="loading-text">
              <span class="spinner"></span>
              Guardando...
            </span>
          </button>
        </form>
      </div>

      <!-- Success State -->
      <div class="success-content" *ngIf="isSubmitted">
        <!-- Success Icon -->
        <div class="success-icon-wrapper">
          <div class="success-icon">ğŸ‰</div>
          <div class="success-checkmark">âœ“</div>
        </div>

        <!-- Success Message -->
        <div class="success-message">
          <h2>Contrasena actualizada</h2>
          <p>Tu contrasena ha sido cambiada exitosamente. Ya puedes iniciar sesion con tu nueva contrasena.</p>
        </div>

        <!-- Security Tips -->
        <div class="tips-card">
          <h4>Consejos de seguridad:</h4>
          <ul>
            <li>No compartas tu contrasena con nadie</li>
            <li>Usa contrasenas diferentes para cada cuenta</li>
            <li>Considera usar un gestor de contrasenas</li>
          </ul>
        </div>

        <!-- Actions -->
        <div class="success-actions">
          <button class="btn-primary" (click)="goToLogin()">
            Iniciar sesion
          </button>
        </div>
      </div>

    </div>
  </div>
</div>
