<div class="login-page">
  <!-- Left Panel - Branding -->
  <div class="brand-panel">
    <div class="brand-content">
      <!-- Decorative Elements -->
      <div class="decoration decoration-1"></div>
      <div class="decoration decoration-2"></div>
      <div class="decoration decoration-3"></div>

      <!-- Logo -->
      <div class="logo-container">
        <span class="logo-j">J</span><span class="logo-slash">/</span><span class="logo-ai">AI1</span>
      </div>

      <!-- Main Text -->
      <h1 class="brand-title">Crea tu nueva<br><span class="highlight">contrasena segura.</span></h1>

      <p class="brand-subtitle">
        Elige una contrasena fuerte para proteger tu cuenta y mantener tus datos seguros.
      </p>

      <!-- Feature Pills -->
      <div class="feature-pills">
        <div class="pill">
          <span class="pill-icon">ğŸ”</span>
          <span>Minimo 8 caracteres</span>
        </div>
        <div class="pill">
          <span class="pill-icon">ğŸ›¡ï¸</span>
          <span>Encriptacion segura</span>
        </div>
      </div>

      <!-- Trust Badge -->
      <div class="trust-badge">
        <span class="badge-icon">âœ“</span>
        <span>Tu nueva contrasena sera encriptada de forma segura</span>
      </div>
    </div>
  </div>

  <!-- Right Panel - Form -->
  <div class="form-panel">
    <div class="form-wrapper">
      <!-- Mobile Logo -->
      <div class="mobile-logo">
        <span class="logo-j">J</span><span class="logo-slash">/</span><span class="logo-ai">AI1</span>
      </div>

      <!-- Invalid Token State -->
      @if (!isTokenValid && !isSubmitted) {
        <!-- Back Link -->
        <a class="back-link" (click)="goToLogin()">
          <span class="back-arrow">â†</span>
          Volver al inicio de sesion
        </a>

        <!-- Error State -->
        <div class="error-container">
          <div class="error-icon-large">âš ï¸</div>
          <div class="error-header">
            <h2>Enlace invalido</h2>
            <p>Este enlace de recuperacion no es valido o ha expirado. Por favor solicita uno nuevo.</p>
          </div>
          <button class="btn-primary" (click)="goToForgotPassword()">
            <span>Solicitar nuevo enlace</span>
            <span class="btn-arrow">â†’</span>
          </button>
        </div>
      }

      <!-- Reset Form -->
      @if (isTokenValid && !isSubmitted) {
        <!-- Back Link -->
        <a class="back-link" (click)="goToLogin()">
          <span class="back-arrow">â†</span>
          Volver al inicio de sesion
        </a>

        <!-- Form Header -->
        <div class="form-header">
          <h2>Crea tu nueva contrasena</h2>
          <p>Tu nueva contrasena debe tener al menos 8 caracteres.</p>
        </div>

        <!-- Error Message -->
        @if (errorMessage) {
          <div class="error-alert">
            <span class="error-icon">âš ï¸</span>
            <span>{{ errorMessage }}</span>
          </div>
        }

        <!-- Form -->
        <form class="auth-form" (ngSubmit)="onSubmit()">
          <div class="input-group">
            <label for="newPassword">Nueva contrasena</label>
            <div class="input-wrapper">
              <span class="input-icon">ğŸ”</span>
              <input
                [type]="showPassword ? 'text' : 'password'"
                id="newPassword"
                [(ngModel)]="newPassword"
                name="newPassword"
                placeholder="Minimo 8 caracteres"
                [disabled]="isLoading"
                required
                autocomplete="new-password"
              >
              <button type="button" class="toggle-visibility" (click)="togglePassword()">
                {{ showPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
              </button>
            </div>
          </div>

          <div class="input-group">
            <label for="confirmPassword">Confirmar contrasena</label>
            <div class="input-wrapper">
              <span class="input-icon">ğŸ”</span>
              <input
                [type]="showConfirmPassword ? 'text' : 'password'"
                id="confirmPassword"
                [(ngModel)]="confirmPassword"
                name="confirmPassword"
                placeholder="Repite tu contrasena"
                [disabled]="isLoading"
                required
                autocomplete="new-password"
              >
              <button type="button" class="toggle-visibility" (click)="toggleConfirmPassword()">
                {{ showConfirmPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
              </button>
            </div>
          </div>

          <!-- Password Requirements -->
          <div class="password-requirements">
            <div class="requirement" [class.met]="newPassword.length >= 8">
              <span class="check-icon">{{ newPassword.length >= 8 ? 'âœ“' : 'â—‹' }}</span>
              <span>Minimo 8 caracteres</span>
            </div>
            <div class="requirement" [class.met]="newPassword && newPassword === confirmPassword">
              <span class="check-icon">{{ newPassword && newPassword === confirmPassword ? 'âœ“' : 'â—‹' }}</span>
              <span>Las contrasenas coinciden</span>
            </div>
          </div>

          <button type="submit" class="btn-primary" [disabled]="isLoading">
            @if (isLoading) {
              <span class="spinner"></span>
              <span>Guardando...</span>
            } @else {
              <span>Cambiar contrasena</span>
              <span class="btn-arrow">â†’</span>
            }
          </button>
        </form>
      }

      <!-- Success State -->
      @if (isSubmitted) {
        <div class="success-container">
          <div class="success-icon-wrapper">
            <div class="success-icon">ğŸ‰</div>
            <div class="success-checkmark">âœ“</div>
          </div>

          <div class="success-header">
            <h2>Â¡Contrasena actualizada!</h2>
            <p>Tu contrasena ha sido cambiada exitosamente. Ya puedes iniciar sesion con tu nueva contrasena.</p>
          </div>

          <!-- Tips Card -->
          <div class="tips-card">
            <h4>Consejos de seguridad:</h4>
            <ul>
              <li>No compartas tu contrasena con nadie</li>
              <li>Usa contrasenas diferentes para cada cuenta</li>
              <li>Considera usar un gestor de contrasenas</li>
            </ul>
          </div>

          <button class="btn-primary" (click)="goToLogin()">
            <span>Iniciar sesion</span>
            <span class="btn-arrow">â†’</span>
          </button>
        </div>
      }
    </div>
  </div>
</div>
